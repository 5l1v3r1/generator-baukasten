{# -- Taxonomy Topic -- #}
{# ---------------------------------------------------------------------- #}

{% extends '_layouts/_master.html' %}
{% set bodyClass = 'p-taxonomyTopic' %}
{% set seomaticMeta = seomaticMeta | merge({'seoTitle': category.group().name ~ ': ' ~ category }) %}

{# -- CRITICAL CSS -- #}
{% block appInlineCSS %}
  <style>
    {{ source (_self.getTemplateName() ~ '_critical.min.css', ignore_missing = true) }}
  </style>
{% endblock %}

{# -- Set Query -- #}
{% set entries = craft.entries({
  section: 'articles',
  relatedTo: craft.categories.slug(category.slug),
  limit: 12
  }) %}

{% paginate entries as pageInfo, pageEntries %}

{# -- start: Rel Nav -- #}
{% block siteHeader %}
  {% include '_partials/header/_siteHeaderLinks.html' with {
    pageInfo: pageInfo
  } only %}
{% endblock %}

{# -- App Content -- #}
{% block appContent %}
  {# -- Cache -- #}
  {% cache globally using key category.group().handle ~ category ~ craft.request.path ~ (craft.request.getPageNum ? '/p' ~ craft.request.getPageNum : '') %}
<div class="o-section">
  <div class="o-row">
    {# -- Include Page Title -- #}
    {% include '_molecules/pageTitle/_template.html' with {
      options: {
        object: category
      }
    } only %}
  </div>
</div>

<div class="o-section">
  <div class="o-row">
    {# -- Articles --#}
    {% include '_organisms/articlesList/_template.html' with {
      options: {
        entries: pageEntries,
        pagination: true,
        catNav: true
      }
    } only %}
  </div>
</div>

{# -- Cache End -- #}
  {% endcache %}
{% endblock %}
